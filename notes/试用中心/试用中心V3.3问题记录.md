## 试用中心V3.3一些问题记录

### 1.数组Array的push方法

	push:向数组的末尾添加一个或更多元素，并返回新的长度。

在做一个保存图片到手机相册时，由于对Array的push的返回值生疏了，然后就直接这么写，发现导致应用闪退。

	$("body")
	    // 保存图片到手机相册
	    .on("touchstart", ".wechat-img", e => {
	      timeStamp = +new Date();
	    })
	    .on("touchend", ".wechat-img", e => {
	      let src = $(e.currentTarget).attr("src");
	      if (!src) {
	        _toast.show("图片无法保存");
	        return;
	      }
	      // var imgs = new Array(src);
	      let interval = +new Date() - timeStamp;
	      if (interval > 500) {
	        jsbridge.saveToPhone([].push(src), function (data) {
	          _toast.show("保存图片成功");
	        });
	      }
	    });

要求的格式:

	jsbridge.saveToPhone(数组, callback);

修改后的为：

	$("body")
	    // 保存图片到手机相册
	    .on("touchstart", ".wechat-img", e => {
	      timeStamp = +new Date();
	    })
	    .on("touchend", ".wechat-img", e => {
	      let src = $(e.currentTarget).attr("src");
	      if (!src) {
	        _toast.show("图片无法保存");
	        return;
	      }
	      var imgs = new Array(src);
	      let interval = +new Date() - timeStamp;
	      if (interval > 500) {
	        jsbridge.saveToPhone(imgs, function (data) {
	          _toast.show("保存图片成功");
	        });
	      }
	    })


2.ajax的POST方法的data格式：object和json区别

定义contentType: text/plain，后台需要传JSON的格式过去，但是我直接传了object的过去。需要用**JSON.stringify()**处理下。
data = JSON.stringify(data);

JSON格式：key是一定要用双引号的，单引号都不行。
	{
		"key": value
	}


	// 加入圈子
	service.joinForum = function (data) {
	  if (query.auth) {
	    service.headers.authorization = "XDS " + query.auth;
	  }
	  return service.createAjax({
	    url: service.dataApi["join-forum"],
	    method: "POST",
	    headers: service.headers,
	    contentType: "text/plain",
	    data: JSON.stringify(data)
	  });
	};